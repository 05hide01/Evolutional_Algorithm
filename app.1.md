# サンプルコードのコマンドが提供しているオプション引数

本書のサンプルコードのコマンドは、様々なオプション引数を提供しています。オプション引数の値を変更する事で、実験や機能の挙動を細かく変更し、挙動の違いを確認することができます。

## 1章で使われているコマンド

### experiments/PPO/run_evogym_ppo.pyのオプション引数

experiments/PPO/run_evogym_ppo.pyは以下のオプションを提供しています。

| オプション                | 短縮表記（abbrev) | デフォルト値    | 詳細                                                                                      |
| -------------------- | ------------ | --------- | --------------------------------------------------------------------------------------- |
| --name               | -n           | “{task}”  | 実験の名前です。デフォルトではタスク名が設定されます。                                                             |
| --task               | -t           | Walker-v0 | タスク名です。デフォルトではWalker-v0タスクが設定されます。                                                      |
| --robot              | -r           | default   | envs/evogym/roboto\\\_files/ ディレクトリ内のファイルで設定しているロボットを指定できます。taskごとにデフォルトのロボットが設定されています。 |
| --num-processes      | -p           | 4         | 並列プロセス数です。デフォルトでは4に設定されています。                                                            |
| —steps               | -s           | 256       | 学習データをサンプリングする回数を設定します。デフォルトでは256に設定されています。                                             |
| --num-mini-batch     | -b           | 8         | バッチサイズです。デフォルトでは8に設定されています。                                                             |
| --epoch              | -e           | 8         | エポック数です。デフォルトでは8に設定されています。                                                              |
| --train-iters        | -i           | 2500      | 学習のイテレーション回数です。デフォルトでは2500に設定してあります。                                                    |
| —evaluation-interval | -ei          | 25        | 学習したポリシーを評価するインターバルです。デフォルトでは、イテレーションが25回実行されるごとにポリシーが評価されるように設定されています。                 |
| —learning-rate       | -lr          | 3e-4      | 強化学習PPOにおける学習率です。デフォルトでは3e-4に設定されています。                                                  |
| —gamma               |              | 0.99      | 適応度の割引率です。デフォルトでは、0.99に設定されています。                                                        |
| —clip-param          | -c           | 0.3       | クリップパラメータです。デフォルトでは0.3に設定されています。                                                        |
| —init-log-std        | -std         | 0.1       | 行動分布の初期対数標準偏差の値です。デフォルトでは0.1に設定されています。                                                  |
| —probabilistic       |              | false     | 学習を確率的に行うためのオプションです。デフォルトでは決定論的（deterministic）に評価されるようになっています。                          |
| —no-view             |              | false     | 評価されたロボットの結果を表示するウィンドウを開かないように設定するオプションです。デフォルトではfalseに設定されておりウィンドウが開くようになっています。        |

### experiments/PPO/make_figures.pyのオプション引数

experiments/NEAT-tutorial/make_figures.pyは以下のオプションを提供しています。

| オプション               | 短縮表記（abbrev) | デフォルト値   | 詳細                                                                                                                                                                 |
| ------------------- | ------------ | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
|                     |              |          | 可視化する対象のフォルダ名（タスク名\\\\\\\_ロボット名）を指定します。                                                                                                                            |
| --specified         | -s           |          | ロボットIDを指定して結果を作成します。                                                                                                                                               |
| --save-type         | -st          | gif      | gifかjpg形式を指定します。デフォルトはgif形式です。                                                                                                                                     |
| --track-robot       | -rt          | false    | gif形式のみに有効なオプションです。ロボットを画面で追跡した結果を出力します。デフォルトではfalseに設定されており地形全体を写した結果が出力されます。                                                                                     |
| —interval           | -I           | timestep | jpg形式のみに有効なオプションです。timestep か distance を選択することができます。デフォルトはtimestepです。timestep-intervalで指定した時間間隔でロボットが描画されます。distanceを指定すると distance-intervalで指定した距離間隔でロボットが描画されます。 |
| --resolution-scale  | -rs          | 32.0     | jpg形式のみに有効なオプションです。jpg画像サイズを指定します。デフォルトでは32.0です。もし結果が白黒で表示される場合は、この値を変更してみてください。                                                                                   |
| —start-timestep     |              | 0        | jpg形式のみに有効なオプションです。可視化対象とする開始ステップ数です。デフォルトでは0に設定されており、最初から可視化されます。                                                                                                 |
| --timestep-interval | -ti          | 80       | jpg形式のみに有効なオプションです。ロボットを描画する時間間隔（steps数間隔）を指定します。デフォルトは80 stepsごとに描画されます。                                                                                          |
| —blur               | -b           | 0        | jpg形式のみに有効なオプションです。ロボットの残像を描画するtimestepsを指定します。デフォルトは0に設定されており、軌跡は表示されません。                                                                                         |
| —blur-temperature   | -bt          | 0.6      | jpg形式のみに有効なオプションです。残像の残り具合を調整します。0〜1の値を設定できます。デフォルトでは0.6に設定されています。1.0に近いほどすっきりと消え、0.0に近いほどしつこく残ります。                                                                |
| —distance-interval  | -di          | 0.8      | jpg形式のみに有効なオプションです。distanceベースで描画する際の間隔を指定します。デフォルトは0.8です。                                                                                                         |
| —display-timestep   |              | false    | jpg形式のみに有効なオプションです。ロボットを描画したタイミングのtimestepを表示します。デフォルトではfalseに設定されています。表示したい場合はtrueに設定してください。                                                                      |
| —draw-trajectory    |              | false    | jpg形式のみに有効なオプションです。ロボットの重心の軌跡を線で描画します。                                                                                                                             |
| —probabilistic      |              | false    | PPOによる学習を確率的（probabilistic)に行った場合は、trueに設定することで確率的に評価した結果を描画することができます。デフォルトでは決定論的（deterministic）に評価された可視化結果を描画します。                                                 |
| —num-cores          | -c           | 1        | 並列プロセス数です。デフォルトでは1に設定されています。                                                                                                                                       |
| —not-overwrite      |              | false    | 既に描画したロボットIDをスキップして描画するためのオプションです。デフォルトではfalseに設定されています。既にある結果を上書きしたくない場合はtrueに設定してください。                                                                           |
| —no-multi           |              | false    | 並列処理を無効にするオプションです。デフォルトではfalseに設定されています。並列処理に関するエラーが起きた際はtrueに設定してください。                                                                                            |


## 2章で使われているコマンド

### experiments/NEAT-tutorial/run_circuit.pyのオプション引数

experiments/NEAT-tutorial/run_circuit.pyは以下のオプションを提供しています。

| オプション        | 短縮表記（abbrev) | デフォルト値   | 詳細                                                            |
| ------------ | ------------ | -------- | ------------------------------------------------------------- |
| --name       | -n           | “{task}” | 実験の名前です。デフォルトではタスク名が設定されます。                                   |
| --task       | -t           | xor      | タスク名です。デフォルトではXOR演算子のタスクが設定されます。                              |
| --pop-size   | -p           | 150      | NEATアルゴリズムの集団数です。デフォルトでは150に設定されています。                         |
| --generation | -g           | 300      | NEATアルゴリズムの世代数です。デフォルトでは300に設定されています。                         |
| —error       | -e           | mse      | 正解との誤差を計算する関数です。デフォルトでは平均二乗誤差に設定されています。他には平均絶対誤差（mae)が設定できます。 |
| --num-cores  | -c           | 4        | 並列プロセス数です。デフォルトでは4に設定されています。                                  |

### experiments/NEAT/run_maze.pyのオプション引数

experiments/NEAT-tutorial/run_circuit.pyは以下のオプションを提供しています。

| オプション        | 短縮表記（abbrev) | デフォルト値   | 詳細                                                                                                                                           |
| ------------ | ------------ | -------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| --name       | -n           | “{task}” | 実験の名前です。デフォルトではタスク名が設定されます。                                                                                                                  |
| --task       | -t           | medium   | タスク名です。デフォルトではmeduimの迷路が指定されています。hardも指定可能です（envs/maze/maze\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_files/以下のファイルを指定） |
| --pop-size   | -p           | 500      | NEATアルゴリズムの集団数です。デフォルトでは500に設定されています。                                                                                                        |
| --generation | -g           | 500      | NEATアルゴリズムの世代数です。デフォルトでは300に設定されています。                                                                                                        |
| —timestep    |              | 400      | 1回の実行でロボットが動くことのできるステップ数です。デフォルトでは400に設定してあります。値が大きいほど長い距離をロボットは動くことができます。                                                                   |
| --num-cores  | -c           | 4        | 並列プロセス数です。デフォルトでは4に設定されています。                                                                                                                 |
| —no-plot     |              | false    | 一世代の実行が終わる度に迷路とロボットの辿った軌跡が表示されます。表示させたくない場合は—no-plotを指定して実行してください。                                                                           |

### experiments/NEAT-tutorial/run_circuit.pyのオプション引数

| オプション        | 短縮表記（abbrev) | デフォルト値   | 詳細                                                                                                                                           |
| ------------ | ------------ | -------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| --name       | -n           | “{task}” | 実験の名前です。デフォルトではタスク名が設定されます。                                                                                                                  |
| --task       | -t           | medium   | タスク名です。デフォルトではmeduimの迷路が指定されています。hardも指定可能です（envs/maze/maze\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_files/以下のファイルを指定） |
| --pop-size   | -p           | 500      | NEATアルゴリズムの集団数です。デフォルトでは500に設定されています。                                                                                                        |
| --generation | -g           | 500      | NEATアルゴリズムの世代数です。デフォルトでは300に設定されています。                                                                                                        |
| —timestep    |              | 400      | 1回の実行でロボットが動くことのできるステップ数です。デフォルトでは400に設定してあります。値が大きいほど長い距離をロボットは動くことができます。                                                                   |
| --num-cores  | -c           | 4        | 並列プロセス数です。デフォルトでは4に設定されています。                                                                                                                 |
| —no-plot     |              | false    | 一世代の実行が終わる度に迷路とロボットの辿った軌跡が表示されます。表示させたくない場合は—no-plotを指定して実行してください。                                                                           |

### experiments/NEAT/run_evogym.pyのオプション引数

その他、次のようなオプションが用意されています。

| オプション        | 短縮表記（abbrev) | デフォルト値    | 詳細                                                                                                                                                     |
| ------------ | ------------ | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| --name       | -n           | “{task}”  | 実験の名前です。デフォルトではタスク名\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_ロボット名が設定されます。                                                       |
| --task       | -t           | Walker-v0 | タスク名です。デフォルトではWalker-v0タスクが指定されています。                                                                                                                   |
| —robot       | -r           | cat       | ロボットの形態です。デフォルトでは、猫型の形態 cat が設定されています。ロボットの形態は、envs/evogym/robot\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\_files/ディレクトリに保存されています。 |
| --pop-size   | -p           | 200       | NEATアルゴリズムの集団数です。デフォルトでは200に設定されています。                                                                                                                  |
| --generation | -g           | 500       | NEATアルゴリズムの世代数です。デフォルトでは500に設定されています。                                                                                                                  |
| —eval-num    |              | 1         | 評価回数です。デフォルトでは1に設定されています。Catcher-v0だけは物体の落ちてくる位置が毎回異なっているため評価回数を増やしてください。                                                                              |
| --num-cores  | -c           | 4         | 並列プロセス数です。デフォルトでは4に設定されています。                                                                                                                           |
| —no-view     |              | false     | 一世代の実行が終わる度に最大適応度の結果が表示されます。表示させたくない場合は—no-viewを指定して実行してください。                                                                                          |
